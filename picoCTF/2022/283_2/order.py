import sys
from gmpy2 import *
from Crypto.Util.number import *

f = open('output.txt', 'r').read().splitlines()
n, c = f
n = int(n[4:], 16)
c = int(c[4:], 16)
g = 3

p = 131052114360702045124590183255994762656619199735249535595584576189433831217063554460411328124131583182550346560926925160498149379216442318939260253148179776131274669358880311256595170467109949361229085696186281524216960337055092798404104419557497546926615552390467209477035904656450289254897714380316674157667
q = 95083374650997701825495702975538193996336577136000931396919403621939890232520511874814758757200119975398319285588359163845575443474809874504800714053625580066093081882534983335154185505390296378339787005820402189374454050557796448956331528203487300285343610236214366467194705172455767452698268943235530255623


p_phi_factor = [2, 569, 593, 32797, 33049, 33113, 33247, 33547, 33713, 33961, 34031, 34061, 34649, 34913, 35023, 35221, 36791, 36979, 37747, 37987, 38543, 38567, 38783, 38903, 39251, 39761, 40009, 40693, 41381, 41443, 42131, 42209, 42359, 42391, 43759, 43777, 44683, 45631, 46559, 46589, 48259, 48397, 48649, 48889, 49019, 49391, 50969, 50989, 51193, 52021, 52673, 53231, 53609, 53959, 54001, 54877, 55163, 55201, 55763, 58207, 58439, 59981, 60271, 61933, 62081, 63241, 63839, 65497]
q_phi_factor = [2, 30347, 31081, 66337, 67057, 67699, 71719, 71843, 71971, 74311, 77417, 77699, 77951, 78497, 79967, 81157, 82483, 82963, 83117, 83537, 87517, 88589, 88771, 89753, 89891, 91393, 92551, 93047, 93719, 95101, 95131, 96167, 96737, 98251, 98347, 98837, 98963, 99139, 99317, 99523, 101009, 101183, 101963, 103643, 103837, 105251, 105379, 107897, 108727, 110807, 111091, 112349, 113969, 115001, 116593, 116657, 119389, 121547, 121909, 125453, 125669, 129187, 129313]

phi_factor = set(q_phi_factor + p_phi_factor)
phi_factor = list(phi_factor)
phi_factor.sort()
phi_factor[0] = 4

def orders_subgroup(c, g, p, factor):
    lst = []
    for x in factor:
        C, G = pow(c, (p - 1)//x, p), pow(g, (p - 1)//x, p)
        for i in range(x):
            if pow(G, i, p) == C:
                lst.append(i)
                break
    return lst

def order(g, n, n_phi_Euler_factor, n_phi_Euler):
    for q in n_phi_Euler_factor[::-1]:
        Ord = n_phi_Euler//q
        if pow(g, Ord, n) == 1:
            return Ord
    return n_phi_Euler

ord_g = order(g, n, phi_factor, (p - 1) * (q - 1))
rm_p = orders_subgroup(c, g, p, p_phi_factor)
rm_q = orders_subgroup(c, g, q, q_phi_factor) 

print(ord_g)
print(rm_p)
print(rm_q)

# ord_g = 3620831041249707681837526614894534070355285598225483947704567590841907012699590416231948016710515187458091091333255758171595595641033083736309400409643928552525615771016574204069905126628091574921138579736452244193978524346401965227602432958121312546484970793941595446729171796239738120972142110982378127424943566648943536407620764596225821813291776832376735113844664973843090883837692356157669303472000289784070105578708851239130329196576851269845975332237349620983071050002827602934735173409535571381136533487551597603554084684495113710973324043031393001050506093082012789172941748667129519131950799991435097455247
# rm_p = [0, 1193, 28278, 449, 30649, 6107, 1953, 21417, 33221, 22543, 16897, 30422, 16738, 8172, 22165, 8002, 33430, 7697, 9296, 7347, 33935, 39184, 23472, 1021, 33227, 23065, 30542, 7298, 5730, 1306, 27904, 9555, 15917, 15406, 15638, 30716, 37933, 599, 13899, 12219, 6372, 30551, 24256, 47377, 7871, 41570, 29051, 41068, 42298, 22657, 41081, 28247, 55477, 35190, 17888, 53950, 56355, 22988, 37969, 16905, 38629, 30739, 56640, 31227, 9154, 60834, 23959]
# rm_q = [0, 1521, 23650, 12431, 18674, 36790, 7645, 60811, 45928, 58318, 64676, 4201, 12452, 7577, 47830, 33608, 65544, 35581, 28185, 65083, 82557, 55719, 79820, 44539, 61391, 26232, 63681, 83630, 62585, 10051, 77893, 52166, 29109, 28097, 83163, 54465, 85217, 65728, 62858, 65506, 48052, 77843, 8516, 35562, 78469, 4390, 28876, 92302, 97802, 112883, 76279, 21858, 43706, 106022, 26734, 64146, 89424, 19235, 94567, 113741, 12190, 20074, 86533] 
