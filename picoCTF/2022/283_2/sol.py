from gmpy2 import *
from Crypto.Util.number import *

f = open('output.txt', 'r').read().splitlines()
n, c = f
n = int(n[4:], 16)
c = int(c[4:], 16)
g = 3

p = 131052114360702045124590183255994762656619199735249535595584576189433831217063554460411328124131583182550346560926925160498149379216442318939260253148179776131274669358880311256595170467109949361229085696186281524216960337055092798404104419557497546926615552390467209477035904656450289254897714380316674157667
q = 95083374650997701825495702975538193996336577136000931396919403621939890232520511874814758757200119975398319285588359163845575443474809874504800714053625580066093081882534983335154185505390296378339787005820402189374454050557796448956331528203487300285343610236214366467194705172455767452698268943235530255623

p_phi_factor = [2, 569, 593, 32797, 33049, 33113, 33247, 33547, 33713, 33961, 34031, 34061, 34649, 34913, 35023, 35221, 36791, 36979, 37747, 37987, 38543, 38567, 38783, 38903, 39251, 39761, 40009, 40693, 41381, 41443, 42131, 42209, 42359, 42391, 43759, 43777, 44683, 45631, 46559, 46589, 48259, 48397, 48649, 48889, 49019, 49391, 50969, 50989, 51193, 52021, 52673, 53231, 53609, 53959, 54001, 54877, 55163, 55201, 55763, 58207, 58439, 59981, 60271, 61933, 62081, 63241, 63839, 65497]
q_phi_factor = [2, 30347, 31081, 66337, 67057, 67699, 71719, 71843, 71971, 74311, 77417, 77699, 77951, 78497, 79967, 81157, 82483, 82963, 83117, 83537, 87517, 88589, 88771, 89753, 89891, 91393, 92551, 93047, 93719, 95101, 95131, 96167, 96737, 98251, 98347, 98837, 98963, 99139, 99317, 99523, 101009, 101183, 101963, 103643, 103837, 105251, 105379, 107897, 108727, 110807, 111091, 112349, 113969, 115001, 116593, 116657, 119389, 121547, 121909, 125453, 125669, 129187, 129313]

phi_factor = set(q_phi_factor + p_phi_factor)
phi_factor = list(phi_factor)
phi_factor.sort()
phi_factor[0] = 4

ord_g = 3115219322141007181833839595995778635585432762887005538508643122799448076548407993268988263745478561243225341142506634503859155186310015837647568507911014225108177349329076392724300840271688622211489512781616354414742121070332040341415421473472268385811410471304848208835278742919155750113882137530394264800226781907897564807446879336818915328116522377849610360397407081721588516331267612010411109683830875505052813128085645286011572974938155057731793793673127276836299722320775439998652081778790446118811749327551559613998000693087447432264088783196873199772777297595702954691611123826800434960096189175488627724563

rm_p = [0, 201, 51, 4111, 21895, 21365, 21225, 32854, 14723, 21770, 12330, 1577, 23244, 18453, 18585, 7503, 27344, 21458, 1641, 32252, 28162, 36064, 22290, 35897, 12775, 1549, 24055, 40531, 32410, 14229, 1339, 36703, 38529, 8423, 9820, 10210, 1667, 19224, 38388, 29871, 41165, 31815, 13676, 9228, 28452, 44746, 15711, 41532, 17953, 44743, 10405, 39697, 28018, 17831, 6002, 25973, 47512, 27125, 39777, 55630, 11373, 53414, 56342, 42791, 52283, 61681, 10981, 50675]

rm_q = [0, 13115, 14484, 60818, 49076, 47386, 3715, 3234, 6159, 27086, 47249, 21985, 62963, 75961, 59570, 1049, 11806, 63451, 7379, 18526, 14322, 10333, 57922, 29276, 20689, 12210, 78511, 83592, 12162, 10504, 7414, 10003, 37777, 97127, 89863, 92117, 74702, 24072, 78667, 50596, 83848, 51686, 17664, 41291, 94944, 103068, 86322, 75110, 21213, 55724, 8524, 89358, 64277, 19453, 1375, 104565, 28460, 22771, 16661, 124428, 89127, 52707, 53506]

def crt(a, m):
    M, n, result = 1, len(m), 0
    for x in m:
        M *= x
    b = [M//x for x in m]
    c = [inverse(b[i], m[i]) for i in range(n)]
    for i in range(n):
        result = (result + a[i]*b[i]*c[i])%M
    return result

phi_Euler = (p - 1) * (q - 1)

x_p = crt(rm_p, p_phi_factor)
x_q = crt(rm_q[1:], q_phi_factor[1:])

X = crt([x_p, x_q], [p-1, (q-1)//2]) % ord_g

print(long_to_bytes(X))

# picoCTF{e032a664}
