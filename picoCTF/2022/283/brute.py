from binascii import hexlify
from gmpy2 import *
import math
import os
import sys

e = 3
n = 12460877288564028727335358383983114542341731051548022154034572491197792306193631973075953054981914244972901364570026538015436620745240063350590274031644056900432709397316305570897203361086754488845958051126465417658968484281328161365661685893889073543245641885219392835341114971676623000455528550121577059201133263120601958976737603233507194269119045288269691908582132306697727786774654514376870525616655205178159918358857865468390016722443872424371236141894314463542566640524517054586357683087662030214815870012212922169583417159962678976416791080548477646303068353009493394710675105136107796547980740025506715311541
c = 4683476596663001825247982301062378592756857982494246980845577998029644028328158048968785736050888709448237425623166946564575774714946821670098821718445224449809907661379791032835834481948814136760697211745028547127222748394760728524163799506384994952602189886585863786326503423002332579249219642710049598165618734058809809967276044001444034396622966899395504922903793796145449014308431273541802709584724358107944445464029059231563995531284398954558536929263711798340934522981579419900012792165843985417112792785658660787778391089209155010351570330771153316983518695389221747975968707090258928792946129208568273891850

# c = e^FLAG % n

# brute force powers of 3 until one works

alph = 'abcdefghijklmnopqrstuvwxyz'
nums = '0123456789'
FLAG = 'picoCTF'

for a in alph:
    for b in alph:
        for c in nums:
            for d in nums:
                for d in nums:
                    for f in nums:
                        for g in nums:
                            for h in nums:
                                cur = FLAG + '{' + a+b+c+d+f+g+h + '}'
                                curFLAG = mpz(hexlify(FLAG.encode()), 16)
                                curC = pow(e, curFLAG, n)
                                if c == curC:
                                    print(cur)
                                    f = open('cur.txt', 'w')
                                    f.write(cur)
                                    sys.exit(1)

